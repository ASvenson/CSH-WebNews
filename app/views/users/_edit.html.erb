<div id="dialog">
  <h2>Settings</h2>
  <%= form_for @current_user,
      :url => update_user_path, :html => { :method => 'put'}, :remote => true do |f| %>
    
    <%= f.fields_for :preferences do |p| %>
      <fieldset>
        <legend>Newsgroup view</legend>
        <div class="form_element">
          <%= p.radio_button :thread_mode, 'normal', :checked => @current_user.thread_mode == :normal %>
          <%= p.label :thread_mode, 'Threaded', :value => 'normal' %>
          <%= p.radio_button :thread_mode, 'flat', :checked => @current_user.thread_mode == :flat %>
          <%= p.label :thread_mode, 'Flat', :value => 'flat' %>
          <%= p.radio_button :thread_mode, 'hybrid', :checked => @current_user.thread_mode == :hybrid %>
          <%= p.label :thread_mode, 'Hybrid', :value => 'hybrid' %>
          <p class="explain">Hybrid view flattens replies like Flat, but keeps them grouped under the original post like Threaded</p>
      </fieldset>
      
      <fieldset>
        <legend>Unread post options</legend>
        <div class="form_element">
          <%= p.check_box :unread_in_test, :checked => @current_user.unread_in_test? %>
          <%= p.label :unread_in_test, 'Show unread posts in csh.test' %>
        </div>
        <div class="form_element">
          <%= p.check_box :unread_in_control, :checked => @current_user.unread_in_control? %>
          <%= p.label :unread_in_control, 'Show unread posts in control groups (e.g. control.cancel)' %>
        </div>
        <div class="form_element">
          <%= p.check_box :unread_in_lists, :checked => @current_user.unread_in_lists? %>
          <%= p.label :unread_in_lists, 'Show unread posts in mailing list groups (e.g. csh.lists.alumni)' %>
        </div>
      </fieldset>
      
      <div class="form_element">
        <%= p.label :time_zone, 'Display post times in this time zone:' %>
        <%= p.time_zone_select :time_zone,
          ActiveSupport::TimeZone.us_zones, :default => @current_user.time_zone %>
      </div>
    <% end %>
    
    <p>Your &quot;real name&quot; is taken from the Common Name (CN) field in the CSH LDAP database. You can change this field using <a href="<%= PROFILES_URL + @current_user.username %>">Member Profiles</a>. This may also change your displayed &quot;real name&quot; on other CSH services.</p>
    
    <div class="buttons">
      <%= f.submit 'Save', :class => 'button green' %>
      <a href="#" class="button red dialog_cancel">Cancel</a>
    </div>
  <% end %>
  
  <div class="loading"></div>
  <div class="errors"></div>
</div>
